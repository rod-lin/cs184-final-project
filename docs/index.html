<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Compound Lenses, Contrast-based Autofocus, Spectral Ray-Tracing and Lens Flare</title><style>
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="a1dc8763-d11d-4ea1-a2ea-9240695f31dc" class="page sans"><header><h1 class="page-title">Compound Lenses, Contrast-based Autofocus, Spectral Ray-Tracing and Lens Flare</h1></header><div class="page-body"><p id="1c688850-b457-437b-bb31-361b20c398c8" class="">Author: Zhengyao Lin, Zhiyuan Zhang</p><h2 id="01e2203b-2a07-48c5-8365-b078de8bbf97" class="">Results</h2><p id="f968d220-db6b-4e76-8dc0-42c7fd1f65bb" class="">Repo (Spectral ray tracing branch): <a href="https://github.com/rod-lin/cs184-final-project">https://github.com/rod-lin/cs184-final-project</a></p><p id="e1472d7f-6ee7-4b70-ae30-edbc6f281da7" class="">Repo (Lens flare branch): <a href="https://github.com/rod-lin/cs184-final-project/tree/lens-flare">https://github.com/rod-lin/cs184-final-project/tree/lens-flare</a></p><p id="1a0da4f6-7e88-425d-82b3-7f9447adce90" class="">Slides: <a href="https://docs.google.com/presentation/d/1cc0Xo1FLeFhsyTrWoue7w3p4l1fEKbvMgpfgjoPSq4I">https://docs.google.com/presentation/d/1cc0Xo1FLeFhsyTrWoue7w3p4l1fEKbvMgpfgjoPSq4I</a></p><p id="99578810-c55a-445e-8edf-81cef74452ad" class="">Video:</p><figure id="e5d1e9b7-cab9-4518-bb2f-be1bd71163dc"><div class="source"><a href="https://youtu.be/X7i6ooUKzBM">https://youtu.be/X7i6ooUKzBM</a></div></figure><hr id="94e81d8c-3d60-4973-a2e8-5a6201542684"/><h2 id="05108617-da05-46a5-a982-de9e08611fcc" class="">Abstract</h2><p id="9d2ad2bf-5545-4793-bd46-3785e2b829a6" class="">For our final project, we decide to implement realistic compound lenses based on the ray tracer from the class. In order to get more realistic rendering, we added multiple physics-based rendering features. To find the correct focus of the lens, we developed a contrast-based autofocus function. We added an internal reflection between the lens elements to produce realistic lens flare. We used spectral ray-tracing to produce the chromatic aberration effect. </p><h2 id="c635563e-5014-4621-9462-53111ea7bbff" class="">Technical Approach</h2><h3 id="c42a33bd-9ad7-45d3-9688-9dbff5f4e09c" class="">Compound Lens</h3><p id="0d2fa4ee-78ad-4525-9998-f92f9af48ec5" class="">In assignment 3.2, we are asked to implement a thin lens camera model, which allowed the pathtracer to render photorealistic effects like depth of field and out-of-focus blur. While this model is closer to real cameras than the pinhole model, we can actually do better by modelling a compound lens with real data and achieve additional realism. Our approach generally follows the old version of assignment 3 from Spring 2016 [1]. We model a compound lens as a list of sphere surfaces, each with a radius (for the sphere) and an aperture size. Each surface lies between two mediums with potentially different indices of refraction. To model how light physically travels through this lens, we implemented a similar algorithm to trace a ray through these surfaces, considering only refraction (and we will generalize this to reflection as well in the lens flare section).</p><figure id="fb303f6a-d43f-4188-b920-307436f3182d" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/compound-lens-example.png"><img style="width:1033px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/compound-lens-example.png"/></a><figcaption>Example by Kolb et al. [3], each row describes a surface in the lens</figcaption></figure><p id="d6e5c0ca-8863-4984-bc07-293d452292ee" class="">To visualize the compound lens and debugging, we also transplanted the old lenstester to our project, here is an image showing how rays are traced through different lenses:</p><div id="64b4a476-fdf4-47df-84d0-2d22d382d033" class="column-list"><div id="1f3b18ed-00f9-4ef8-b3fc-9961ce925005" style="width:50%" class="column"><figure id="29141dcd-36eb-483a-8b17-97a70aac0ebb" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-wide-1.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-wide-1.png"/></a><figcaption>Wide-angle lens</figcaption></figure></div><div id="b7880e93-267a-40a7-b9a6-2919c7199996" style="width:50%" class="column"><figure id="7898db1b-30c9-4639-a5b2-57b5ec9ac6e3" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-dgauss-1.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-dgauss-1.png"/></a><figcaption>D-Gauss lens</figcaption></figure></div></div><div id="c27f9553-ead1-4411-8d21-c4db252b3ad9" class="column-list"><div id="c8a0112e-3397-4e6c-b081-4646431d090e" style="width:50%" class="column"><figure id="cd60d001-9808-4f5c-875b-3ccf575ce9d7" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-fisheye-1.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-fisheye-1.png"/></a><figcaption>Fisheye lens</figcaption></figure></div><div id="8c2b793b-122d-487e-8855-5decb53a5af8" style="width:50%" class="column"><figure id="2559975a-e0a8-4ab2-9c22-bf5a7ff0351a" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-tele-1.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lenstester-basic-tele-1.png"/></a><figcaption>Telephoto lens</figcaption></figure></div></div><p id="a01e69fc-68a3-4c26-bfd8-34d03fb61f45" class="">Some parameters we computed (through simulation) for these lenses are:</p><div id="1d570461-5e15-403b-9f3d-4a633431f930" class="collection-content"><h4 class="collection-title">Lens parameters</h4><table class="collection-content"><thead><tr><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesTitle"><path d="M7.73943662,8.6971831 C7.77640845,8.7834507 7.81338028,8.8943662 7.81338028,9.00528169 C7.81338028,9.49823944 7.40669014,9.89260563 6.91373239,9.89260563 C6.53169014,9.89260563 6.19894366,9.64612676 6.08802817,9.30105634 L5.75528169,8.33978873 L2.05809859,8.33978873 L1.72535211,9.30105634 C1.61443662,9.64612676 1.2693662,9.89260563 0.887323944,9.89260563 C0.394366197,9.89260563 0,9.49823944 0,9.00528169 C0,8.8943662 0.0246478873,8.7834507 0.0616197183,8.6971831 L2.46478873,2.48591549 C2.68661972,1.90669014 3.24119718,1.5 3.90669014,1.5 C4.55985915,1.5 5.12676056,1.90669014 5.34859155,2.48591549 L7.73943662,8.6971831 Z M2.60035211,6.82394366 L5.21302817,6.82394366 L3.90669014,3.10211268 L2.60035211,6.82394366 Z M11.3996479,3.70598592 C12.7552817,3.70598592 14,4.24823944 14,5.96126761 L14,9.07922535 C14,9.52288732 13.6549296,9.89260563 13.2112676,9.89260563 C12.8169014,9.89260563 12.471831,9.59683099 12.4225352,9.19014085 C12.028169,9.6584507 11.3257042,9.95422535 10.5492958,9.95422535 C9.60035211,9.95422535 8.47887324,9.31338028 8.47887324,7.98239437 C8.47887324,6.58978873 9.60035211,6.08450704 10.5492958,6.08450704 C11.3380282,6.08450704 12.040493,6.33098592 12.4348592,6.81161972 L12.4348592,5.98591549 C12.4348592,5.38204225 11.9172535,4.98767606 11.1285211,4.98767606 C10.6602113,4.98767606 10.2411972,5.11091549 9.80985915,5.38204225 C9.72359155,5.43133803 9.61267606,5.46830986 9.50176056,5.46830986 C9.18133803,5.46830986 8.91021127,5.1971831 8.91021127,4.86443662 C8.91021127,4.64260563 9.0334507,4.44542254 9.19366197,4.34683099 C9.87147887,3.90316901 10.6232394,3.70598592 11.3996479,3.70598592 Z M11.1778169,8.8943662 C11.6830986,8.8943662 12.1760563,8.72183099 12.4348592,8.37676056 L12.4348592,7.63732394 C12.1760563,7.29225352 11.6830986,7.11971831 11.1778169,7.11971831 C10.5616197,7.11971831 10.056338,7.45246479 10.056338,8.0193662 C10.056338,8.57394366 10.5616197,8.8943662 11.1778169,8.8943662 Z M0.65625,11.125 L13.34375,11.125 C13.7061869,11.125 14,11.4188131 14,11.78125 C14,12.1436869 13.7061869,12.4375 13.34375,12.4375 L0.65625,12.4375 C0.293813133,12.4375 4.43857149e-17,12.1436869 0,11.78125 C-4.43857149e-17,11.4188131 0.293813133,11.125 0.65625,11.125 Z"></path></svg></span>Lens</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>Infinity focus</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>Near focus</th><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>True focal length</th></tr></thead><tbody><tr id="06efa939-564c-4f7d-8ac1-7575c94694a8"><td class="cell-title"><a href="https://www.notion.so/Wide-angle-06efa939564c4f7d8ac17575c94694a8">Wide-angle</a></td><td class="cell-N:0a">28.757mm</td><td class="cell-[;eN">34.501mm</td><td class="cell-QWbW">22.013mm</td></tr><tr id="f0a4b2cf-01b0-41df-a3c4-eceaae285487"><td class="cell-title"><a href="https://www.notion.so/D-Gauss-f0a4b2cf01b041dfa3c4eceaae285487">D-Gauss</a></td><td class="cell-N:0a">51.255mm</td><td class="cell-[;eN">63.462mm</td><td class="cell-QWbW">50.324mm</td></tr><tr id="f83dcd44-23d8-4251-ba1d-d689ca861a62"><td class="cell-title"><a href="https://www.notion.so/Fisheye-f83dcd4423d84251ba1dd689ca861a62">Fisheye</a></td><td class="cell-N:0a">28.607mm</td><td class="cell-[;eN">32.015mm</td><td class="cell-QWbW">9.9237mm</td></tr><tr id="fd2ce0be-84c1-490a-aa15-4d434a74752b"><td class="cell-title"><a href="https://www.notion.so/Telephoto-fd2ce0be84c1490aaa154d434a74752b">Telephoto</a></td><td class="cell-N:0a">188.69mm</td><td class="cell-[;eN">258.19mm</td><td class="cell-QWbW">249.44mm</td></tr></tbody></table></div><p id="812a28ff-22a1-462a-b77b-0d1313218a95" class="">And here are some images rendered using the compound lens model:</p><figure id="15331d5b-69cd-4bb2-97d7-caaadf66cabb" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/CBspheres-fisheye-s256-l8-m100.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/CBspheres-fisheye-s256-l8-m100.png"/></a><figcaption>Fisheye lens</figcaption></figure><figure id="cd487eee-1375-4fc8-abe2-e378ddb808bc" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/CBspheres-wide-s256-l8-m100.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/CBspheres-wide-s256-l8-m100.png"/></a><figcaption>Wide-angle lens</figcaption></figure><p id="156054f8-9e10-45f6-9428-3e3475d5ad4f" class="">One problem that we faced was that if we load the lens data as it is (which have a unit in millimeters), the resulting lens has a small radius (usually in the order of &lt; 100mm), which resulted in a small aperture size and therefore wide depth of field. So we did not immediately observe any blur due to depth of field in the images above (but things can indeed get out of focus). Below are images of the same scene but with slightly enlarged lenses, from which we can see a more narrow depth of field:</p><figure id="d2d79610-3d51-475a-bca9-442ca5d2e920" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/CBdragon-wide-s256-l8-m10.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/CBdragon-wide-s256-l8-m10.png"/></a></figure><h3 id="c0c5b9d1-7695-470f-a061-79b3e5dc5209" class="">Lens flare</h3><p id="857c553e-a5b1-47ca-8247-c5b7efabb1d8" class="">In the compound lens section, we only considered refractions in the lens. But in reality, light could also reflect between lenses, creating more complicated paths within the lens. Lens flare is then an artifact created (primarily) by such internal reflections in a real lens system. There are some common components of the lens flare effect. For example, in the following image, there are multiple half-transparent octagons lying alone a line, and these are called “ghosts”, which are reflected and distorted images of the light source, and whose shape is determined by the aperture shape. There is also this star shape around the light source, which is called the starbursts and the shape of it is also determined by the aperture shape.</p><figure id="574ca902-22b5-41aa-be3b-0476d73172d4" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-example-1.png"><img style="width:1440px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-example-1.png"/></a><figcaption>Ghosts and starbursts</figcaption></figure><p id="6c20a081-781c-40e3-960e-2e09e25ff284" class="">We partially implemented the effect of ghosts, by allowing rays to reflect within the lens system. The probability of refraction or reflection (when there is no total internal reflection), is determined by the Fresnel equations (which we approximate using the Schlick&#x27;s approximation), just like in assignment 3-2. For example, showing below are a few rays going through the lens that both refracted and reflected. We can see that they could go through a very complicated path.</p><figure id="9aa5e43c-beac-42ff-83a8-5921fabad67d" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-wide-3.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-wide-3.png"/></a></figure><figure id="5d27a85f-d417-4e83-a48f-8e04776f6635" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-dgauss-1.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-dgauss-1.png"/></a><figcaption>Notice the bouncing in the left lens element</figcaption></figure><figure id="dcb6d3a3-4677-4382-af3e-acca7e6f3148" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-fisheye-1.png.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-fisheye-1.png.png"/></a></figure><figure id="8720e7aa-a1c6-4772-be35-ac9364a60091" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-tele-1.png"><img style="width:820px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lentester-reflection-1-ray-tele-1.png"/></a></figure><p id="97e64fb0-e67d-43cb-a85f-14239a523703" class="">However, since we have not implemented spectral/wavelength-dependent ray tracing yet, there is no effect caused by dispersion in our ghosts (like aberration), and all ghosts appear in a single color. For the sampling method, we partially implemented the importance sampling method described by Pekkarinen et al. [2], which samples a point A in the light source, and a point B on the front lens element, and traces the ray from A to B into the lens system.</p><p id="dd4c89f7-0391-4cd7-9828-4952e68b021d" class="">Here are some results rendered using our implementation (using the wide-angle lens provided in the old assignment 3-2). The images are quite noisy as we are still working on correctly weighing the radiance of the rays. Also as we increase the max number of reflections (which has to be even to reach the sensor), more ghosts appear in the image.</p><figure id="4ba5da40-80ba-4f1f-8e87-ea550654fb11" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-2-sample-1000000000.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-2-sample-1000000000.png"/></a><figcaption>Max 2 reflections, 1000000000 samples</figcaption></figure><figure id="fc50b0c4-16fc-4361-9194-4e5ba5b843c8" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-4-sample-1000000000.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-4-sample-1000000000.png"/></a><figcaption>Max 4 reflections, 1000000000 samples</figcaption></figure><figure id="a61fe9b1-75b6-4484-ab1e-1466dde5d02c" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-6-sample-1000000000.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-6-sample-1000000000.png"/></a><figcaption>Max 6 reflections, 1000000000 samples</figcaption></figure><figure id="20013b29-6c9a-499b-8a56-b6fbd185feb9" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-8-sample-1000000000.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-8-sample-1000000000.png"/></a><figcaption>Max 8 reflections, 1000000000 samples</figcaption></figure><figure id="6d5bbd2b-767d-42e2-b9bf-d0be5dcb6885" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-16-sample-1000000000.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-16-sample-1000000000.png"/></a><figcaption>Max 16 reflections, 1000000000 samples</figcaption></figure><figure id="baea4774-e032-45a9-ad01-cd81095c562b" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-100-sample-1000000000.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-100-sample-1000000000.png"/></a><figcaption>Max 100 reflections, 1000000000 samples</figcaption></figure><p id="f41c1dcc-2073-42e5-9ee3-8192aa25d131" class="">Also, since the shape of the ghosts are largely determined by the aperture shape, if we change it to polygons, the ghosts will begin to have a polygonal shape.</p><figure id="e4b268b8-106a-46fc-a055-ac6d2419b12d" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-100-sample-1000000000-pentagon.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-100-sample-1000000000-pentagon.png"/></a><figcaption>Pentagon aperture</figcaption></figure><figure id="497e38e9-e7c5-405e-a0b3-f11ac59b8224" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-100-sample-1000000000-hexagon.png"><img style="width:800px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/lens-flare-wide-angle-max-bounce-100-sample-1000000000-hexagon.png"/></a><figcaption>Hexagon aperture</figcaption></figure><h2 id="737f76e8-492e-497d-ac82-92a8cc726844" class="">Contrast-based Autofocus</h2><p id="d9158aa9-abf3-4f68-9b47-d4ac445bb9a9" class="">From assignment 3.2, since the thin lens just needs a focus distance, the focusing can just be done by setting the focus distance to the distance to the object of interest. But for the compound lens, it is not as simple, the distance from the lens to the sensor has a complex relationship to the focus distance, thus, we need a function to find the focus point. </p><p id="2ab3c8fa-9557-42bc-9621-406204f1f7c8" class="">To determine if the object is in focus, I used variance as suggested by the old project spect. The higher the variance in the sampling area, the more in focus the object is. The reason is that high contrast basically is that there is a large difference in different parts of the image. </p><p id="5806f56d-7983-4717-b511-de986f5f00b4" class="">I choose to sample a 21 by 21 pixel sample where the mouse click is the middle pixel. And then calculate the variance just like assignment 3-1 did for adaptive sampling. The result is: </p><figure id="1e2a35ac-44d3-4f18-9cb6-79051fdf3ada" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_11.20.56_PM.png"><img style="width:1034px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_11.20.56_PM.png"/></a><figcaption>x axis: sample number, y axis: variance. </figcaption></figure><p id="c391de72-911a-409f-83c0-06ae490dd0eb" class="">I will sample the entire focus range in a more efficient way, instead of linearly. Since the Gauss&#x27;s ray tracing formula have inverse relationships, I decided to sample with an inverse function. The sampling focus distance for the above chart is: </p><figure id="98f8a97f-1632-48c8-9d4d-1dcf893091bb" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_11.21.05_PM.png"><img style="width:1034px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_11.21.05_PM.png"/></a><figcaption>x axis: sample number, y axis: focus distance. </figcaption></figure><p id="40b44978-0e31-48f4-9edc-7322c257291a" class="">(The above chart is autofocus for the thin lens model, but the compound lens works similarly. Instead of setting the focus distance, the compound lens autofocus algorithm will sample from Infinite focal distance to close focal distance with an inverses function, since we set the distance between the lens and the sensor for focusing. )</p><p id="d3e5da8b-b585-4e6f-8fe0-9cbb4be036fa" class="">After this full range sample, I sample again in the range with the highest variance to fine-tune the focus for achieving the best result. The sampling function is linear since, in small range, the inverses function can be approximate by a linear function. The sampling variance is: </p><figure id="3778f8bd-4b2e-48a5-9bcb-ce6db6abd51e" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_11.21.14_PM.png"><img style="width:1034px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_11.21.14_PM.png"/></a><figcaption>x axis: sample number, y axis: variance. </figcaption></figure><p id="154864d0-9b56-47a3-9315-f63a0b138e4b" class="">Now, the focus distance/sensor-lens distance with highest variance is found. All the sample image in this project used this autofocus funtion to render.</p><h2 id="5335d5f5-b8ca-4016-a45c-1692a7465958" class="">Spectral Ray-Tracing</h2><p id="5d1e8731-1954-4c64-be08-c4be937e878c" class="">In the real world, light with different wavelengths does not have the same index of refraction. That is the reason why dispersive prism can sperate sunlight into a spectrum. This part of the project takes large inspiration from a past CS184 project (The link can be found: <a href="https://people.eecs.berkeley.edu/~cecilia77/graphics/a6/">https://people.eecs.berkeley.edu/~cecilia77/graphics/a6/</a>). The glass material properties are found from <a href="https://refractiveindex.info/">https://refractiveindex.info/</a>. </p><p id="6ba8fa53-8555-476a-a1f7-b65f55a456dc" class="">Since the 3 color value representing the color in the ray tracer is a representation of human&#x27;s 3 vision cells, I sampled each global illumination sample 3 times with 3 different colors. To get a more accurate result, instead of using a constant value for each color&#x27;s wavelength, I constructed a Monte Carlo estimator. I approximate human vision cell wavelength response curves with 3 normal distribution for time efficiency and sample random wavelength using these distractions as PDF. The ray generated from the sensor now will have a color and a wavelength. The ray will only consistent 1 color value. After getting the result, the color value will be multiplied by 3 to compensate for the loss of brightness. </p><figure id="432a3de8-f5a7-49b5-9a23-342acb51cf74" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/1200px-Cones_SMJ2_E.svg.png"><img style="width:1200px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/1200px-Cones_SMJ2_E.svg.png"/></a><figcaption>Human vison response curve</figcaption></figure><p id="2af9f64d-997c-42d6-abd6-f0e594511bc8" class="">
</p><p id="00c350eb-67bd-49ad-95f5-b09f4c415cb9" class="">After the ray is generated, it will go through the compound lens. For each lens element, I looked through the online reference for optical glass material, to find a glass with a similar index of refraction. I modified the file parser to take in additional material data for each element. The dispersion function with respect of wavelength is as follow: </p><figure id="4e77e1e6-32c9-4354-aca5-2f0a3eea9162" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_6.42.48_PM.png"><img style="width:720px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_6.42.48_PM.png"/></a></figure><figure id="acfa385e-94a7-4bd4-9821-6dc81e301ceb" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_6.41.34_PM.png"><img style="width:1004px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_6.41.34_PM.png"/></a><figcaption>The Dispersion function</figcaption></figure><p id="1f3dc5d2-407f-43b7-bf5f-001af62ab3ba" class="">Using these 6 constant and wavelength, I can solve for the index of reflection for that particular lens element at that particular wavelength. Using the &quot;real_ior&quot; the ray tracer can produce realistic lens chromatic aberration. </p><figure id="748547ed-419a-462f-b036-323e20918a07" class="image"><a href="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_7.07.45_PM.png"><img style="width:1184px" src="Compound%20Lenses,%20Contrast-based%20Autofocus,%20Spectra%20fb303f6ad43f4188b920307436f3182d/Screen_Shot_2020-08-13_at_7.07.45_PM.png"/></a><figcaption>The result of using 22mm lens, 2048 sample/pixel, 8 sample/light, depth 8.</figcaption></figure><p id="b7db0a02-63d6-4550-97e5-96591dc65968" class="">Analysis of the result: From the dispersion function, we can see that light with longer wavelengths tends to have a lower index of refraction. Thus, as you can see from the image, the edge around the highlight that is further away from the lens center will appear purple, red-ish. It is because the red light with longer wavelength will be &quot;bend&quot; less by the lens, thus appear on the images&#x27; edge. Similarly, the edge closer to the lens center will appear blue because blue has a shorter wavelength, thus is &quot;bend&quot; more.</p><h2 id="7ffd5d44-34a0-4897-a9c9-cab6621e7044" class="">Contribution of Team Member</h2><p id="a86b0ced-1196-4fce-a965-b5d2b952e712" class="">Zhengyao Lin: Compund Lens, Lens Flare Rendering. </p><p id="f51a5a7e-88a8-442f-9bd8-5186bb8a2bb0" class="">Zhiyuan Zhang: Contrast-based Autofocus, Spectral Ray-tracing. </p><h2 id="3d371abe-4a81-4452-b4ed-7b63818c4e59" class="">Reference</h2><ol id="003291fa-a8e8-4357-8f42-3cb9cb197c44" class="numbered-list" start="1"><li><a href="https://cs184.eecs.berkeley.edu/sp16/article/19">https://cs184.eecs.berkeley.edu/sp16/article/19</a></li></ol><ol id="d584dca0-9adf-455a-bdca-8f1db0716085" class="numbered-list" start="2"><li><a href="https://dl.acm.org/doi/pdf/10.1145/3329715.3338881">https://dl.acm.org/doi/pdf/10.1145/3329715.3338881</a></li></ol><ol id="5d391f87-0b40-45ec-8b89-34543c8ae244" class="numbered-list" start="3"><li><a href="https://www.cs.utexas.edu/~fussell/courses/cs395t/lens.pdf">https://www.cs.utexas.edu/~fussell/courses/cs395t/lens.pdf</a></li></ol><p id="ddf02482-bc3a-4b41-9fa8-804ae89b3b4e" class="">
</p></div></article></body></html>